# --- T2-COPYRIGHT-NOTE-BEGIN ---
# T2 SDE: package/*/reaction/hotfix-makefile.patch
# Copyright (C) 2023 - 2024 The T2 SDE Project
# 
# This Copyright note is generated by scripts/Create-CopyPatch,
# more information can be found in the files COPYING and README.
# 
# This patch file is dual-licensed. It is available under the license the
# patched project is licensed under, as long as it is an OpenSource license
# as defined at http://www.opensource.org/ (e.g. BSD, X11) or under the terms
# of the GNU General Public License version 2 as used by the T2 SDE.
# --- T2-COPYRIGHT-NOTE-END ---

Add some standard Makefile variables to accomodate with the T2 build system.

  - NoTag <notag@t2sde.org>

--- reaction-v1.1.1/Makefile.vanilla	2024-01-11 11:44:11.312798166 +0100
+++ reaction-v1.1.1/Makefile	2024-01-11 11:46:43.893791490 +0100
@@ -1,13 +1,17 @@
+CC ?= gcc
+PREFIX ?= /usr/local
+BINDIR = $(PREFIX)/bin
+
 all: reaction ip46tables
 
 clean:
 	rm -f reaction ip46tables reaction.deb deb reaction.minisig ip46tables.minisig reaction.deb.minisig
 
 ip46tables: ip46tables.d/ip46tables.c
-	gcc -s -static ip46tables.d/ip46tables.c -o ip46tables
+	$(CC) -static ip46tables.d/ip46tables.c -o ip46tables
 
 reaction: app/* reaction.go go.mod go.sum
-	CGO_ENABLED=0 go build -buildvcs=false -ldflags "-s -X main.version=`git tag --sort=v:refname | tail -n1` -X main.commit=`git rev-parse --short HEAD`"
+	CGO_ENABLED=0 go build -buildvcs=false
 
 reaction.deb: reaction ip46tables
 	chmod +x reaction ip46tables
@@ -24,3 +28,6 @@
 signatures: reaction.deb reaction ip46tables
 	minisign -Sm ip46tables reaction reaction.deb
 
+install: all
+	@install -m755 reaction $(DESTDIR)$(BINDIR)
+	@install -m755 ip46tables $(DESTDIR)$(BINDIR)
