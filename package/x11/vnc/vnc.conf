# --- T2-COPYRIGHT-NOTE-BEGIN ---
# T2 SDE: package/*/vnc/vnc.conf
# Copyright (C) 2004 - 2022 The T2 SDE Project
# 
# This Copyright note is generated by scripts/Create-CopyPatch,
# more information can be found in the files COPYING and README.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License version 2.
# --- T2-COPYRIGHT-NOTE-END ---

xvnc_inject_x() {
	cd unix
	for x in `match_source_file -p 'X.*src'`; do
		echo "Extracting ${x##*/} ..."
		tar $taropt $x
	done
	patch -Np0 < xc.patch
	cd ..
}

hook_add prepatch 5 "xvnc_inject_x"
hook_add preconf 5 "cd unix"

[ "$SDECFG_PKG_VNC_X_SERVER" = 1 ] &&
	hook_add inmake 5 "cd xc; make makeopt=WORLDOPTS= World; cd .."

pkginstalled zlib && var_append confopt ' ' '--with-installed-zlib'
makeinstopt=

hook_add postmake 5 './vncinstall $bindir $mandir'
#hook_add postmake 6 'mkdir -p $datadir/$pkg/classes; cp -v java/* $datadir/$pkg/classes'
